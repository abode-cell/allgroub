'use client';

import jsPDF from 'jspdf';
import autoTable from 'jspdf-autotable';
import type { User } from '@/lib/types';
import { amiriFont } from '@/lib/amiri-font';

// PNG Data URI for the logo, as SVG is not supported by default in jsPDF
const logoPngDataUri = 'data:image/png;base64,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';


type ExportOptions = {
  title: string;
  user: User;
  columns: string[];
  rows: (string | number)[][];
  filename: string;
};

export const exportToPdf = ({
  title,
  user,
  columns,
  rows,
  filename,
}: ExportOptions) => {
  const doc = new jsPDF();

  // Add Amiri font for Arabic support
  try {
    doc.addFileToVFS('Amiri-Regular.ttf', amiriFont);
    doc.addFont('Amiri-Regular.ttf', 'Amiri', 'normal');
    doc.setFont('Amiri');
  } catch (e) {
    console.error("Could not add font to PDF", e);
  }

  // Header
  const today = new Date().toLocaleDateString('ar-SA', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });

  const pageWidth = doc.internal.pageSize.getWidth();
  const pageHeight = doc.internal.pageSize.getHeight();

  // Logo
  doc.addImage(logoPngDataUri, 'PNG', pageWidth - 28, 12, 14, 14);

  // Title
  doc.setFontSize(10);
  doc.text('مجموعة عال', 20, 20, { align: 'left' });
  doc.setFontSize(18);
  doc.text(title, pageWidth / 2, 28, { align: 'center' });

  // Footer
  const pageCount = (doc.internal as any).getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(10);
    doc.text(
      `تاريخ التصدير: ${today}`,
      pageWidth - 20,
      pageHeight - 10,
      { align: 'right' }
    );
    doc.text(`تم التصدير بواسطة: ${user.name}`, 20, pageHeight - 10, {
      align: 'left',
    });
     doc.text(
      `صفحة ${i} من ${pageCount}`,
      pageWidth / 2,
      pageHeight - 10,
      { align: 'center' }
    );
  }


  // Table
  autoTable(doc, {
    head: [columns],
    body: rows,
    startY: 40,
    styles: {
      font: 'Amiri',
      halign: 'right', // Align all cell text to the right for Arabic
    },
    headStyles: {
      fillColor: [15, 44, 89], // Primary color #0F2C59
      textColor: [255, 255, 255],
      fontStyle: 'bold',
      halign: 'center', // Center align header text
    },
    alternateRowStyles: {
      fillColor: [244, 244, 245], // Muted color from globals.css
    },
    didDrawPage: (data) => {
        // Footer on each page
        doc.setFontSize(10);
        doc.text(
            `تاريخ التصدير: ${today}`,
            data.settings.margin.right,
            pageHeight - 10,
            { align: 'right' }
        );
        doc.text(`تم التصدير بواسطة: ${user.name}`, data.settings.margin.left, pageHeight - 10, {
            align: 'left',
        });
        const pageNum = doc.internal.getNumberOfPages();
        doc.text(
            `صفحة ${pageNum}`,
            pageWidth / 2,
            pageHeight - 10,
            { align: 'center' }
        );
    }
  });

  doc.save(`${filename}.pdf`);
};
